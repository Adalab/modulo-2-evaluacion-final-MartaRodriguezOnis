"use strict";const searchInput=document.querySelector(".js_searchInput"),searchBtn=document.querySelector(".js_searchBtn"),resetBtn=document.querySelector(".js_resetBtn"),resultUl=document.querySelector(".js_resultUl"),favouritetUl=document.querySelector(".js_favouritetUl"),deleteFavBtn=document.querySelector(".js_deleteFavBtn");let results=[],favourites=[];function handleBtnReset(e){e.preventDefault(),searchInput.value="",resultUl.innerHTML=""}function handleDeleteFav(e){e.preventDefault(),favourites.splice(0,favourites.length),renderAnimeFav()}function handleRemoveFav(e){const t=parseInt(e.currentTarget.name);console.log(t);const n=favourites.findIndex(e=>e.id===t);favourites.splice(n,1),renderAnimeFav(),renderAnimeResult()}resetBtn.addEventListener("click",handleBtnReset),deleteFavBtn.addEventListener("click",handleDeleteFav);const listenerIcon=()=>{const e=document.querySelectorAll(".js_iconRemove");for(const t of e)t.addEventListener("click",handleRemoveFav)},renderAnimeFav=()=>{let e="";for(const t of favourites)e+=`<li class="js_liFav" id="${t.id}">`,e+=`<img src="${t.img}" alt="Imagen del anime ${t.title}">`,e+='<div class="divFavourites">',e+=`<h2>${t.title}</h2>`,e+=`<img src="./assets/images/cancelar.png" class="js_iconRemove" name="${t.id}"></i>`,e+="</div></li>";favouritetUl.innerHTML=e,listenerAnime(),listenerIcon(),localStorage.setItem("favouritesLS",JSON.stringify(favourites))};function handleClickFav(e){const t=parseInt(e.currentTarget.id),n=results.find(e=>e.id===t),i=favourites.findIndex(e=>e.id===t);-1===i?favourites.push(n):favourites.splice(i,1),renderAnimeFav(),renderAnimeResult()}const listenerAnime=()=>{const e=document.querySelectorAll(".js_liAnime");for(const t of e)t.addEventListener("click",handleClickFav)},renderAnimeResult=()=>{let e="",t="";for(const n of results){t=-1!==favourites.findIndex(e=>n.id===e.id)?"favourite":"",e+=`<li class="js_liAnime ${t}" id="${n.id}">`,"https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png"!==n.img?e+=`<img src="${n.img}" alt="Imagen del anime ${n.title}">`:e+='<img src="https://via.placeholder.com/200x200/ffffff/666666/?text=SIN IMAGEN" alt="No hay imagen disponible">',e+=`<h2 class="${t}__title">${n.title}</h2>`,e+="</li>"}resultUl.innerHTML=e,listenerAnime(),listenerIcon()};function handleClick(e){e.preventDefault();const t=searchInput.value;fetch("https://api.jikan.moe/v4/anime?q="+t).then(e=>e.json()).then(e=>{results=e.data.map((function(e){return{img:e.images.jpg.image_url,title:e.title,id:e.mal_id}})),renderAnimeResult()})}function loadPage(){const e=JSON.parse(localStorage.getItem("favouritesLS"));e&&(favourites=e,renderAnimeFav())}searchBtn.addEventListener("click",handleClick),loadPage();